import tkinter as tk
from tkinter import filedialog, ttk
import subprocess


def run_exe():
    filetypes = [("Executable Files", "*.exe"), ("DLL Files", "*.dll"), ("OLE Files", "*.ole")]
    filepath = filedialog.askopenfilename(filetypes=filetypes)

    if filepath:
        output_text.delete(1.0, tk.END)

        try:
            result = subprocess.run(["python3", "main.py", filepath], capture_output=True, text=True)

            output_text.insert(tk.END, result.stdout)
            output_text.insert(tk.END, result.stderr)
        except Exception as e:
            output_text.insert(tk.END, f"An error occurred: {e}")

window = tk.Tk()
window.title("R&D Project Model")
window.geometry("1500x700")

upload_button = tk.Button(window, text="Upload Suspicious Malware File", command=run_exe)
upload_button.pack(pady=20)

output_text = tk.Text(window, height=40, width=180)
output_text.pack()

window.mainloop()